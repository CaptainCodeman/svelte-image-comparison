import{S as G,i as K,s as Q,k as E,q as Y,a as ee,w as te,l as I,m as P,r as Z,h as w,c as ne,x as ae,n as _,b as L,F as C,y as se,f as oe,t as re,z as ie,o as le,R as ce,W as he,C as pe,J as q,X as fe}from"../../../chunks/paths-6994077d.js";import{I as me}from"../../../chunks/ImageComparison-a435fb9f.js";var z=new WeakMap,b;function de(e,t){return b=b||new ResizeObserver(s=>{for(let n of s){let r=z.get(n.target);r&&r(n)}}),z.set(e,t),b.observe(e),{destroy(){b.unobserve(e),z.delete(e)}}}var D=(e,t)=>Math.hypot(e.x-t.x,e.y-t.y),H=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),N=(e,t)=>({x:e.x-t.x,y:e.y-t.y});function ue(e,t){let s=window.devicePixelRatio,n=e.getContext("2d"),r,i,l,u,o,h,c=e.width=e.clientWidth*s,T=e.height=e.clientHeight*s;function M(a){({width:i,height:l,render:u,padding:o,maxZoom:h}={padding:0,maxZoom:16,...a}),r=Math.min(e.width/(i+o*s),e.height/(l+o*s)),n.resetTransform(),n.translate(e.width/2,e.height/2),n.scale(r,r),n.translate(-i/2,-l/2),x()}M(t);let U=de(e,a=>{let m=a.contentRect,p=v({x:c/2,y:T/2}),f=n.getTransform();c=m.width*s,T=m.height*s,e.width=c,e.height=T,r=Math.min(e.width/(t.width+o*s),e.height/(t.height+o*s)),n.setTransform(f);let d=v({x:e.width/2,y:e.height/2});n.translate(d.x-p.x,d.y-p.y),x()}),g=new Map;function k(a){a.stopPropagation(),e.setPointerCapture(a.pointerId);let m=$(a);g.set(a.pointerId,m)}function y(a){a.stopPropagation(),e.releasePointerCapture(a.pointerId),g.delete(a.pointerId)}function A(a){if(a.stopPropagation(),!g.has(a.pointerId))return;let m=$(a);switch(g.size){case 1:{let p=g.get(a.pointerId),f=N(v(m),v(p));S(f),x(),g.set(a.pointerId,m);break}case 2:{let p=[...g.values()],f=v(p[0]),d=v(p[1]),V=H(f,d),j=D(f,d);g.set(a.pointerId,m),p=[...g.values()],f=v(p[0]),d=v(p[1]);let X=H(f,d),B=D(f,d),F=N(X,V);S(F);let J=B/j;W(X,J);break}}}function R(a){a.preventDefault(),a.stopPropagation();let m=$(a),p=Math.exp(-a.deltaY/512);W(v(m),p)}function S(a){n.translate(a.x,a.y)}function W(a,m){function p(d){n.translate(a.x,a.y),n.scale(d,d),n.translate(-a.x,-a.y)}p(m);let f=n.getTransform();f.a<r&&p(r/f.a),f.a>h&&p(h/f.a),x()}function $(a){return{x:a.offsetX*s,y:a.offsetY*s}}function v(a){return n.getTransform().inverse().transformPoint(a)}function x(){n.save(),n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.restore(),u(n)}return e.addEventListener("pointerdown",k,{passive:!0}),e.addEventListener("pointerup",y,{passive:!0}),e.addEventListener("pointercancel",y,{passive:!0}),e.addEventListener("pointermove",A,{passive:!0}),e.addEventListener("wheel",R),{update(a){M(a)},destroy(){U.destroy(),e.removeEventListener("pointerdown",k),e.removeEventListener("pointerup",y),e.removeEventListener("pointercancel",y),e.removeEventListener("pointermove",A),e.removeEventListener("wheel",R)}}}function ge(e){let t,s,n,r;return{c(){t=E("canvas"),this.h()},l(i){t=I(i,"CANVAS",{slot:!0,class:!0}),P(t).forEach(w),this.h()},h(){_(t,"slot","left"),_(t,"class","svelte-135yf06")},m(i,l){L(i,t,l),n||(r=ce(s=ue.call(null,t,e[1])),n=!0)},p(i,l){s&&he(s.update)&&l&2&&s.update.call(null,i[1])},d(i){i&&w(t),n=!1,r()}}}function ve(e){let t;return{c(){t=E("canvas"),this.h()},l(s){t=I(s,"CANVAS",{slot:!0,id:!0,class:!0}),P(t).forEach(w),this.h()},h(){_(t,"slot","right"),_(t,"id","right"),_(t,"class","svelte-135yf06")},m(s,n){L(s,t,n),e[2](t)},p:pe,d(s){s&&w(t),e[2](null)}}}function we(e){let t,s,n,r,i,l,u;return l=new me({props:{class:"w-full h-[480px] mt-4",$$slots:{right:[ve],left:[ge]},$$scope:{ctx:e}}}),{c(){t=E("p"),s=Y("Using with "),n=E("a"),r=Y("svelte-pan-zoom"),i=ee(),te(l.$$.fragment),this.h()},l(o){t=I(o,"P",{class:!0});var h=P(t);s=Z(h,"Using with "),n=I(h,"A",{class:!0,href:!0});var c=P(n);r=Z(c,"svelte-pan-zoom"),c.forEach(w),h.forEach(w),i=ne(o),ae(l.$$.fragment,o),this.h()},h(){_(n,"class","text-blue-700 underline"),_(n,"href","https://www.npmjs.com/package/svelte-pan-zoom"),_(t,"class","mt-2 text-gray-600")},m(o,h){L(o,t,h),C(t,s),C(t,n),C(n,r),L(o,i,h),se(l,o,h),u=!0},p(o,[h]){const c={};h&131&&(c.$$scope={dirty:h,ctx:o}),l.$set(c)},i(o){u||(oe(l.$$.fragment,o),u=!0)},o(o){re(l.$$.fragment,o),u=!1},d(o){o&&w(t),o&&w(i),ie(l,o)}}}function O(e){return new Promise(t=>{const s=new Image;s.onload=()=>t(s),s.src=e})}function _e(e,t,s){let n,r,i,l,u={width:1920,height:1080,render:o};function o(c){i&&(c.drawImage(i,0,0),console.log(c.getTransform()),r.save(),r.resetTransform(),s(0,n.width=c.canvas.width,n),s(0,n.height=c.canvas.height,n),r.setTransform(c.getTransform()),r.drawImage(l,0,0),r.restore())}le(async()=>{[i,l]=await Promise.all([O(q+"/animal-ga395c165e_1920a.webp"),O(q+"/animal-ga395c165e_1920b.webp")]),r=n.getContext("2d"),s(1,u={width:i.width,height:i.height,render:o})});function h(c){fe[c?"unshift":"push"](()=>{n=c,s(0,n)})}return[n,u,h]}class be extends G{constructor(t){super(),K(this,t,_e,we,Q,{})}}export{be as default};
