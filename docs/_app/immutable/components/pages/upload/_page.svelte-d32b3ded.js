import{S as A,i as $,s as D,k as p,a as T,w as I,l as g,m as h,c as P,x as k,h as u,n as m,b as v,D as b,y as z,O as L,f as C,t as U,z as O,q as R,r as S,T as V,B as j,U as q}from"../../../chunks/index-a0e11c75.js";import{I as x}from"../../../chunks/ImageComparison-93d6bd1d.js";import{X as F}from"../../../chunks/index-7008f21d.js";function N(l,e){function t(n){n.stopPropagation(),n.preventDefault(),l.setAttribute("dragging",""),n.dataTransfer.dropEffect="copy"}function a(n){n.stopPropagation(),n.preventDefault(),l.removeAttribute("dragging"),n.dataTransfer.dropEffect="copy"}function s(n){n.stopPropagation(),n.preventDefault(),l.setAttribute("dragging",""),n.dataTransfer.dropEffect="copy"}function r(n){n.stopPropagation(),n.preventDefault(),l.removeAttribute("dragging");var o=n.dataTransfer;for(let i=0;i<o.items.length;i++){const c=o.items[i];if(c.kind==="file"){const d=c.getAsFile();d&&e(d)}}}return document.addEventListener("dragenter",t,!1),document.addEventListener("dragleave",a,!1),document.addEventListener("dragover",s,!1),document.addEventListener("drop",r,!1),{destroy(){document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",a),document.removeEventListener("dragover",s),document.removeEventListener("drop",r)}}}function w(l){let e,t;return{c(){e=p("p"),t=R("Drop two same-size images onto the page to compare ..."),this.h()},l(a){e=g(a,"P",{class:!0});var s=h(e);t=S(s,"Drop two same-size images onto the page to compare ..."),s.forEach(u),this.h()},h(){m(e,"class","absolute m-4 text-gray-600 z-10")},m(a,s){v(a,e,s),b(e,t)},d(a){a&&u(e)}}}function B(l){let e,t,a,s;return{c(){e=p("canvas"),this.h()},l(r){e=g(r,"CANVAS",{slot:!0,class:!0}),h(e).forEach(u),this.h()},h(){m(e,"slot","left"),m(e,"class","svelte-t4v511")},m(r,n){v(r,e,n),a||(s=L(t=F.call(null,e,l[2])),a=!0)},p(r,n){t&&V(t.update)&&n&4&&t.update.call(null,r[2])},d(r){r&&u(e),a=!1,s()}}}function W(l){let e;return{c(){e=p("canvas"),this.h()},l(t){e=g(t,"CANVAS",{slot:!0,id:!0,class:!0}),h(e).forEach(u),this.h()},h(){m(e,"slot","right"),m(e,"id","right"),m(e,"class","svelte-t4v511")},m(t,a){v(t,e,a),l[4](e)},p:j,d(t){t&&u(e),l[4](null)}}}function X(l){let e,t,a,s,r,n,o=!l[1]&&w();return a=new x({props:{class:"w-full h-full",$$slots:{right:[W],left:[B]},$$scope:{ctx:l}}}),{c(){e=p("div"),o&&o.c(),t=T(),I(a.$$.fragment),this.h()},l(i){e=g(i,"DIV",{class:!0});var c=h(e);o&&o.l(c),t=P(c),k(a.$$.fragment,c),c.forEach(u),this.h()},h(){m(e,"class","absolute inset-0")},m(i,c){v(i,e,c),o&&o.m(e,null),b(e,t),z(a,e,null),s=!0,r||(n=L(N.call(null,e,l[3])),r=!0)},p(i,[c]){i[1]?o&&(o.d(1),o=null):o||(o=w(),o.c(),o.m(e,t));const d={};c&517&&(d.$$scope={dirty:c,ctx:i}),a.$set(d)},i(i){s||(C(a.$$.fragment,i),s=!0)},o(i){U(a.$$.fragment,i),s=!1},d(i){i&&u(e),o&&o.d(),O(a),r=!1,n()}}}function G(l){return new Promise(e=>{const t=new Image;t.onload=()=>e(t),t.src=l})}function H(l,e,t){let a,s,r,n,o={width:1920,height:1080,render:i};function i(f){r&&(f.drawImage(r,0,0),n&&(s||(s=a.getContext("2d")),s.save(),s.resetTransform(),t(0,a.width=f.canvas.width,a),t(0,a.height=f.canvas.height,a),s.setTransform(f.getTransform()),s.drawImage(n,0,0),s.restore()))}let c=!0;async function d(f){if(!f.type.startsWith("image/"))return;const _=URL.createObjectURL(f),E=await G(_);URL.revokeObjectURL(_),c?t(1,r=E):n=E,t(2,o={width:r.width,height:r.height,render:i}),c=!c}function y(f){q[f?"unshift":"push"](()=>{a=f,t(0,a)})}return[a,r,o,d,y]}class Q extends A{constructor(e){super(),$(this,e,H,X,D,{})}}export{Q as default};
